<!DOCTYPE HTML>
<html>
	<head>
		<title>Remote Control</title>
		<meta charset="utf-8">
		<link rel="shortcut icon" type="image/png" href="http://bobboteck.github.io/img/roberto-damico-bobboteck.png">
		<style>
			* {
				box-sizing: border-box;
			}
			body {
				margin: 0px;
				padding: 0px;
				font-family: monospace;
			}
			.container {
				display: grid;
				grid-template-columns: repeat(2, 1fr);
				grid-gap: 20px;
				padding: 20px;
			}
			.joystick-container {
				width: 100%;
				text-align: center;
			}
			.joystick-container-gimbal {
				width: 100%;
				text-align: center;
			}
			.joystick {
				width: 200px;
				height: 200px;
				margin: 0 auto;
				border: 1px solid #000;
			}
			.joystick-gimbal {
				width: 600px;
				height: 600px;
				margin: 0 auto;
				border: 1px solid #000;
			}
			.slider-container {
				margin-top: 30px;
			}
			.slider-label {
				display: block;
				text-align: center;
			}
			.slider {
				width: 300px;
				margin: 0 auto;
			}
			.joystick-heading {
				font-weight: bold;
				font-size: 16px;
				margin-bottom: 10px;
			}
			.toggle-button {
				appearance: none;
				-webkit-appearance: none;
				border: none;
				border-radius: 20px;
				background-color: #ccc;
				width: 60px;
				height: 34px;
				cursor: pointer;
				position: relative;
				overflow: hidden;
			}

			.toggle-button:before {
				content: "";
				position: absolute;
				top: 2px;
				left: 2px;
				width: 30px;
				height: 30px;
				background-color: #fff;
				border-radius: 50%;
				transition: 0.4s;
			}

			.toggle-button.active:before {
				transform: translateX(26px);
			}

      .center {
          text-align: center;
      }

      .controller-status {
          font-weight: bold;
          text-align: center;
      }

      #controller-connected {
          color: green;
      }
        
      #controller-connected-area {
          display: none;
      }
        
      #controller-not-connected-area {
          color: darkred;
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
      }
        
      #rumble-on-button-press-area {
          margin-bottom: 10px;
          text-align: center;
      }

      .loader {
          display: inline-block;
          border: 8px solid #484848;
          border-radius: 50%;
          border-top: 8px solid #3498db;
          border-bottom: 8px solid #3498db;
          width: 20px;
          height: 20px;
          -webkit-animation: spin 1.5s linear infinite;
          animation: spin 1.5s linear infinite;
      }

      @keyframes spin {
          0% {
            transform: rotate(0deg);
          }
          100% {
            transform: rotate(360deg);
          }
      }

      #buttons {
        display: grid;
        grid-template-columns: repeat(8, minmax(min-content, max-content));
        grid-gap: 15px;
        justify-content: center;
        justify-items: start;
      }

      .axis-name {
        color: grey;
        font-weight: bolder;
      }

      .selected-button {
        fill: rgb(231, 24, 24);
      }

      .button {
        background-color: rgb(223, 222, 222);
        height: 50px;
        min-width: 50px;
        display: flex;
      }
      
      .button-text-area {
        padding-left: 10px;
        padding-right: 10px;
      }
      
      .button-name {
        color: grey;
      }

      .axis-value {
        color: rgb(126, 54, 54);
      }
      
      a {
        color: red;
      }
              
    </style>
    
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();
    </script>

    <script src="utf8.js"></script>

	</head>

	<body>

		<div class="slider-container">
			<div class="joystick-heading">Slider 2</div>
			<input id="slider2" class="slider" type="range" min="0" max="100" step="1" value="0">
			<span id="sliderValue2">0</span>
		</div>

		<div class="slider-container">
			<div class="joystick-heading">Toggle Switch 2</div>
			<button id="toggleButton2" class="toggle-button"></button>
			<span id="toggleValue2">0</span>
		</div>
		<div class="container">
			<div class="joystick-container">
				<div class="joystick-heading">Joy1: Forward and Backward Control</div>
				<div id="joy1Div" class="joystick"></div>
				Position X:<input id="joy1PosizioneX" type="text" /><br />
				Position Y:<input id="joy1PosizioneY" type="text" /><br />
				Direction:<input id="joy1Direzione" type="text" /><br />
				X :<input id="joy1X" type="text" /><br />
				Y :<input id="joy1Y" type="text" />
			</div>
			<div class="joystick-container">
				<div class="joystick-heading">Joy2: Left and Right Control</div>
				<div id="joy2Div" class="joystick"></div>
				Position X:<input id="joy2PosizioneX" type="text" /><br />
				Position Y:<input id="joy2PosizioneY" type="text" /><br />
				Direction:<input id="joy2Direzione" type="text" /><br />
				X :<input id="joy2X" type="text" /><br />
				Y :<input id="joy2Y" type="text" />
			</div>
		</div>


    <div id="controller-not-connected-area" class="controller-status">
        <div class="loader"></div>
        <div>Controller not connected. Press any button to start.</div>
    </div>

    <div id="controller-connected-area">
        <div id="controller-connected" class="controller-status">Connected</div>
        <div id="rumble-on-button-press-area">
          <input id="rumble-on-button-press" type="checkbox" />
          <label for="rumble-on-button-press">Rumble on button press</label>
        </div>
        <div id="buttons"></div>
    </div>

    <div class="center">
        <svg
          version="1.1"
          id="Capa_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          width="600px"
          height="500px"
          xml:space="preserve"
          width="10%"
          height="10%"
          viewBox="0 0 600 500"
        >
          <g>
            <g>
              <path
                id="controller-b13"
                name="down"
                d="M114.003,255.595c-5.043,3.696-10.324,8.09-11.102,9.663c-1.353,2.705-3.244,17.252-2.889,22.24
              c0.073,1.053,0.306,4.26,13.972,4.266l0.042,3.06v-3.06c13.666-0.006,13.898-3.213,13.972-4.271
              c0.355-4.976-1.53-19.523-2.889-22.234C124.407,263.851,119.682,259.762,114.003,255.595z"
              />
  
              <rect
                id="controller-b8"
                name="select"
                x="227.994"
                y="238.771"
                width="18.898"
                height="7.711"
              />
  
              <path
                id="controller-b12"
                name="up"
                d="M114.003,232.84c5.686-4.167,10.404-8.256,11.108-9.669c1.353-2.699,3.244-17.246,2.889-22.24
              c-0.08-1.053-0.306-4.254-13.972-4.26c-13.708,0.006-13.935,3.207-14.015,4.26c-0.355,4.987,1.53,19.535,2.889,22.24
              C103.685,224.744,108.96,229.15,114.003,232.84z"
              />
              <path
                id="controller-b14"
                name="left"
                d="M92.962,233.11c-2.46-1.229-14.584-2.925-20.918-2.925c-0.502,0-0.937,0.012-1.31,0.042
              c-1.059,0.074-4.266,0.301-4.271,13.966c0.006,13.709,3.213,13.936,4.266,14.009c0.379,0.031,0.82,0.043,1.316,0.043
              c6.34,0,18.464-1.688,20.918-2.925c1.671-0.839,6.353-6.573,9.676-11.102C98.936,239.181,94.529,233.893,92.962,233.11z"
              />
              <path
                id="controller-b15"
                name="right"
                d="M157.284,230.234c-0.379-0.031-0.82-0.043-1.316-0.043c-6.34,0-18.464,1.689-20.924,2.925
              c-1.566,0.784-5.973,6.065-9.669,11.108c3.317,4.528,7.999,10.27,9.669,11.102c2.46,1.23,14.584,2.925,20.918,2.925
              c0.496,0,0.936-0.012,1.31-0.042c1.059-0.074,4.266-0.3,4.271-13.966c0-0.05,0-0.092,0-0.129
              C161.525,230.528,158.336,230.301,157.284,230.234z"
              />
              <circle id="controller-b3" cx="465.824" cy="194.529" r="19.866" />
              <circle id="controller-b1" cx="512.446" cy="241.152" r="19.865" />
              <circle id="controller-b0" cx="465.824" cy="287.774" r="19.865" />
              <circle id="controller-b2" cx="419.202" cy="241.152" r="19.865" />
              <polygon
                id="controller-b9"
                name="select"
                points="333.062,246.586
                349.171,241.751 333.062,237.381"
              />
              <path
                id="layout"
                d="M561.234,241.611c-2.441-18.305-10.171-52.075-43.531-75.264l-8.14-31.328c0,0-0.813-7.729-10.985-13.428
              c0,0,0.612-5.288-8.745-7.729c-9.357-2.442-31.127-7.117-56.549,1.426c0,0-3.868,1.016-3.66,6.714c0,0-12.001,5.899-14.443,16.885
              c-2.441,10.985-5.697,24.816-5.697,24.816h-36.916H211.195h-39.56c0,0-3.256-13.831-5.698-24.816s-14.443-16.885-14.443-16.885
              c0.202-5.698-3.66-6.714-3.66-6.714c-25.429-8.543-47.191-3.868-56.549-1.426c-9.357,2.441-8.746,7.729-8.746,7.729
              c-10.171,5.698-10.985,13.428-10.985,13.428l-8.14,31.328c-33.36,23.188-41.09,56.959-43.532,75.264
              C17.441,259.921,1.579,380.344,0.354,394.58c-1.218,14.241-2.032,67.534,46.788,75.264s74.45-36.615,74.45-36.615l32.956-57.161
              c73.636,57.161,108.624-20.545,108.624-20.545h54.774c0,0,34.988,77.706,108.624,20.545l32.956,57.161
              c0,0,25.631,44.345,74.45,36.615s48.005-61.028,46.787-75.264C579.546,380.338,563.677,259.916,561.234,241.611z M465.824,168.544
              c14.326,0,25.985,11.658,25.985,25.985c0,14.326-11.659,25.985-25.985,25.985c-14.327,0-25.985-11.659-25.985-25.985
              C439.839,180.203,451.497,168.544,465.824,168.544z M317.322,191.175c3.776,0,7.552,0,11.322,0
              c0.036,0.129,0.049,1.983,0.012,2.265c-0.062,0.006-0.128,0.013-0.195,0.013c-0.386,0-0.777,0-1.163,0
              c-0.043,0-0.086,0-0.129,0.006c-0.152,0.024-0.238,0.122-0.208,0.275c0.024,0.116,0.073,0.245,0.141,0.343
              c0.116,0.171,0.251,0.324,0.392,0.478c1.114,1.218,2.222,2.43,3.336,3.642c0.03,0.03,0.061,0.055,0.104,0.092
              c0.049-0.056,0.099-0.104,0.147-0.153c1.261-1.377,2.515-2.754,3.775-4.131c0.031-0.031,0.062-0.067,0.08-0.104
              c0.086-0.128,0.062-0.251-0.056-0.349c-0.098-0.079-0.208-0.098-0.336-0.098c-0.392,0.006-0.79,0-1.182,0
              c-0.055,0-0.11-0.013-0.177-0.019c0-0.759,0-1.506,0-2.265c3.06,0,6.113,0,9.18,0c0,0.753,0,1.5,0,2.271c-0.067,0-0.135,0-0.202,0
              c-0.746,0-1.493,0-2.233,0c-0.123,0-0.208,0.037-0.294,0.123c-2.411,2.57-4.822,5.141-7.234,7.711
              c-0.079,0.086-0.109,0.165-0.109,0.281c0.006,0.991,0,1.977,0,2.969c0,0.042,0,0.085,0.006,0.128
              c0.019,0.196,0.116,0.312,0.318,0.337c0.085,0.012,0.171,0,0.263,0c0.839,0,1.677,0,2.516,0c0.024,0,0.049,0.006,0.086,0.012
              c0,0.68,0,1.353,0,2.032c-3.709,0-7.405,0-11.114,0c0-0.68,0-1.353,0-2.05c0.073,0,0.141,0,0.208,0c0.716,0,1.426,0,2.142,0
              c0.074,0,0.153,0,0.227-0.007c0.232-0.024,0.355-0.159,0.374-0.397c0-0.037,0-0.073,0-0.11c0-1.034,0-2.068,0-3.103
              c0-0.122-0.031-0.208-0.117-0.3c-2.282-2.503-4.571-5.007-6.848-7.51c-0.086-0.098-0.178-0.135-0.306-0.135
              c-0.833,0.007-1.665,0-2.497,0c-0.067,0-0.135,0-0.215,0C317.322,192.681,317.322,191.935,317.322,191.175z M289.892,191.169
              c0.079-0.006,0.159-0.006,0.238-0.006c2.51,0,5.025,0,7.535,0c0.109,0,0.227,0.006,0.336,0c0.135-0.013,0.232,0.03,0.337,0.122
              c0.691,0.631,1.383,1.255,2.074,1.879c2.84,2.559,5.674,5.116,8.514,7.675c0.055,0.049,0.11,0.098,0.202,0.178
              c0-0.11,0.006-0.184,0.006-0.251c0-2.032,0-4.058,0-6.09c0-0.159,0-0.312,0-0.471c0.006-0.258-0.11-0.441-0.324-0.575
              c-0.196-0.123-0.41-0.178-0.643-0.178c-0.704,0-1.402,0-2.105,0c-0.067,0-0.135,0-0.215,0c0-0.766,0-1.506,0-2.252
              c0,0,0.007-0.007,0.013-0.013s0.013-0.013,0.013-0.013c3.139-0.006,6.272-0.006,9.412-0.012c0.037,0,0.073,0.006,0.122,0.006
              c0,0.753,0,1.506,0,2.276c-0.073,0-0.141,0-0.208,0c-0.679,0-1.353,0-2.031-0.006c-0.569,0-0.82,0.239-0.845,0.814
              c-0.007,0.085-0.007,0.177-0.007,0.263c0,4.113,0,8.231,0,12.344c0,0.08,0,0.159,0,0.251c-0.073,0.007-0.122,0.013-0.177,0.013
              c-1.065,0-2.13,0-3.195,0c-0.109,0-0.189-0.03-0.269-0.104c-4.07-3.623-8.14-7.239-12.21-10.862
              c-0.049-0.043-0.104-0.086-0.184-0.153c0,0.098,0,0.159,0,0.221c0,2.723,0,5.446,0,8.17c0,0.104,0.013,0.214,0.024,0.318
              c0.019,0.116,0.092,0.189,0.215,0.208c0.135,0.019,0.275,0.024,0.41,0.024c0.765,0,1.529,0,2.295,0c0.067,0,0.135,0,0.214,0
              c0,0.729,0,1.438,0,2.16c-3.17,0-6.328,0-9.504,0c0-0.716,0-1.426,0-2.16c0.073,0,0.141,0,0.208,0c0.697,0,1.389,0,2.087,0
              c0.079,0,0.165,0,0.244-0.013c0.245-0.036,0.386-0.195,0.398-0.446c0-0.049,0-0.098,0-0.153c0-3.47,0-6.939,0-10.41
              c0-0.049,0-0.098,0-0.152c-0.007-0.294-0.116-0.429-0.398-0.478c-0.135-0.024-0.275-0.037-0.41-0.037
              c-0.648-0.006-1.303,0-1.953,0c-0.067,0-0.135,0-0.227,0C289.892,192.565,289.892,191.879,289.892,191.169z M264.072,195.111
              c0.661-1.077,1.523-1.965,2.54-2.711c1.383-1.016,2.925-1.701,4.584-2.143c1.646-0.44,3.323-0.6,5.024-0.52
              c2.093,0.098,4.101,0.551,5.998,1.456c1.322,0.631,2.515,1.451,3.513,2.534c0.888,0.961,1.549,2.044,1.879,3.316
              c0.453,1.708,0.251,3.354-0.544,4.921c-0.661,1.298-1.628,2.338-2.791,3.201c-1.414,1.046-2.993,1.744-4.682,2.185
              c-0.979,0.257-1.971,0.416-2.98,0.483c-0.392,0.024-0.79,0.006-1.181,0.006c0,0.006,0,0.013,0,0.019
              c-0.508-0.019-1.016-0.006-1.518-0.055c-2.644-0.239-5.098-1.022-7.265-2.589c-1.138-0.82-2.081-1.818-2.76-3.061
              c-0.605-1.107-0.912-2.289-0.875-3.55C263.043,197.351,263.417,196.188,264.072,195.111z M240.008,192.565
              c0.557-0.562,1.206-0.991,1.909-1.353c1.041-0.532,2.136-0.881,3.274-1.126c1.175-0.251,2.356-0.392,3.562-0.38
              c0.937,0.013,1.861,0.123,2.779,0.3c1.322,0.258,2.613,0.637,3.862,1.151c0.25,0.104,0.489,0.244,0.747,0.354
              c0.085,0.037,0.189,0.062,0.288,0.056c0.189-0.013,0.245-0.08,0.245-0.275c0-0.19,0-0.386,0-0.576
              c0.153-0.042,2.148-0.049,2.369-0.012c0,1.836,0,3.672,0,5.521c-0.765,0-1.518,0-2.289,0c-0.012-0.086-0.018-0.159-0.031-0.239
              c-0.092-0.667-0.404-1.218-0.881-1.683c-0.459-0.44-0.998-0.753-1.579-0.998c-0.79-0.343-1.622-0.557-2.466-0.703
              c-1.2-0.215-2.412-0.3-3.629-0.264c-0.899,0.031-1.799,0.104-2.681,0.324c-0.361,0.092-0.709,0.208-1.04,0.38
              c-0.239,0.122-0.465,0.275-0.643,0.478c-0.208,0.232-0.325,0.502-0.343,0.813c-0.012,0.264,0.08,0.49,0.281,0.643
              c0.166,0.129,0.355,0.239,0.545,0.318c0.447,0.196,0.93,0.288,1.414,0.373c0.949,0.166,1.91,0.251,2.871,0.343
              c1.53,0.153,3.066,0.294,4.583,0.563c1.175,0.208,2.326,0.478,3.434,0.942c0.698,0.288,1.353,0.648,1.928,1.15
              c0.894,0.777,1.396,1.75,1.493,2.932c0.135,1.523-0.392,2.772-1.548,3.764c-0.71,0.606-1.524,1.022-2.393,1.353
              c-1.016,0.386-2.068,0.631-3.139,0.796c-0.906,0.135-1.812,0.227-2.729,0.227c-0.563,0-1.126-0.067-1.683-0.159
              c-1.818-0.3-3.605-0.729-5.367-1.268c-0.233-0.073-0.459-0.152-0.673-0.275c-0.208-0.122-0.453-0.116-0.71-0.109
              c0,0.336,0,0.667,0,1.003c-0.912,0-1.805,0-2.699,0c-0.043-0.128-0.062-5.905-0.019-6.261c0.135-0.036,2.375-0.042,2.564-0.006
              c0.024,0.172,0.037,0.343,0.073,0.515c0.141,0.722,0.514,1.31,1.046,1.799c0.594,0.551,1.292,0.924,2.032,1.224
              c0.851,0.343,1.738,0.563,2.644,0.71c1.2,0.196,2.411,0.275,3.629,0.227c0.918-0.036,1.817-0.171,2.68-0.52
              c0.478-0.19,0.912-0.441,1.285-0.796c0.196-0.184,0.368-0.392,0.496-0.631c0.061-0.109,0.073-0.22,0.049-0.343
              c-0.061-0.317-0.232-0.562-0.478-0.765c-0.238-0.195-0.514-0.33-0.802-0.446c-0.575-0.233-1.181-0.367-1.793-0.478
              c-1.022-0.189-2.056-0.307-3.084-0.423c-1.475-0.171-2.95-0.324-4.406-0.594c-1.175-0.22-2.338-0.489-3.439-0.979
              c-0.667-0.294-1.292-0.667-1.806-1.2c-0.648-0.679-0.967-1.486-0.979-2.423C238.741,194.365,239.194,193.391,240.008,192.565z
              M93.911,200.502c0.704-9.938,14.278-9.944,20.067-9.951c5.845,0.007,19.407,0.013,20.123,9.945
              c0.379,5.324-1.414,21.224-3.513,25.41c-1.775,3.55-9.804,9.633-14.578,13.036c-0.135,0.122-0.281,0.226-0.447,0.317
              c-0.483,0.282-1.022,0.423-1.554,0.423c-0.202,0-0.404-0.024-0.6-0.062c-0.238-0.049-0.471-0.122-0.691-0.22
              c-0.263-0.129-0.502-0.275-0.716-0.459c-3.207-2.277-12.663-9.211-14.572-13.036C95.325,221.72,93.525,205.821,93.911,200.502z
              M70.288,264.316c-9.938-0.704-9.945-14.278-9.945-20.073c0-5.839,0.006-19.413,9.951-20.117c0.496-0.036,1.083-0.055,1.75-0.055
              c5.655,0,19.529,1.506,23.66,3.568c3.825,1.909,10.759,11.377,13.036,14.584c0.202,0.238,0.374,0.508,0.496,0.808
              c0.166,0.397,0.245,0.82,0.239,1.236c-0.006,0.452-0.11,0.911-0.318,1.334c-0.116,0.227-0.257,0.44-0.416,0.63
              c-1.805,2.559-9.051,12.589-13.036,14.578c-4.125,2.062-18.005,3.568-23.66,3.568C71.377,264.371,70.784,264.353,70.288,264.316z
              M134.101,287.927c-0.71,9.944-14.278,9.951-20.067,9.957l0,0h-0.024c-5.82-0.006-19.388-0.013-20.092-9.957
              c-0.379-5.312,1.414-21.212,3.513-25.404c1.909-3.819,11.377-10.759,14.578-13.036c0.135-0.116,0.282-0.22,0.441-0.312
              c0.232-0.135,0.477-0.239,0.728-0.312c0.795-0.214,1.659-0.128,2.393,0.294c0.196,0.116,0.379,0.251,0.539,0.397
              c4.798,3.428,12.723,9.443,14.48,12.963C132.681,266.721,134.48,282.615,134.101,287.927z M155.968,264.371
              c-5.649,0-19.529-1.505-23.654-3.567c-3.99-1.989-11.242-12.044-13.036-14.584c-0.128-0.147-0.245-0.318-0.343-0.496
              c-0.293-0.532-0.422-1.132-0.385-1.72c0.024-0.373,0.116-0.74,0.281-1.096c0.123-0.257,0.275-0.495,0.459-0.71
              c2.295-3.219,9.211-12.649,13.023-14.559c4.131-2.062,18.005-3.568,23.66-3.568c0.661,0,1.254,0.019,1.756,0.055
              c9.872,0.704,9.945,14.101,9.945,19.958c0,0.049,0,0.092,0,0.135c-0.006,5.819-0.012,19.394-9.957,20.098
              C157.223,264.353,156.629,264.371,155.968,264.371z M200.111,364.892c-22.326,0-40.49-18.164-40.49-40.484
              c0-22.325,18.164-40.489,40.49-40.489s40.49,18.164,40.49,40.489C240.607,346.728,222.437,364.892,200.111,364.892z
              M253.013,247.712c0,2.692-2.191,4.89-4.89,4.89h-21.358c-2.699,0-4.89-2.19-4.89-4.89v-10.172c0-2.692,2.191-4.89,4.89-4.89
              h21.358c2.699,0,4.89,2.191,4.89,4.89V247.712z M290.559,329.756c-18.74,0-33.991-15.244-33.991-33.99
              c0-18.745,15.245-33.99,33.991-33.99s33.991,15.245,33.991,33.99C324.55,314.512,309.305,329.756,290.559,329.756z
              M332.708,253.08c-0.281,0.092-0.582,0.129-0.882,0.129c-2.692,0-4.89-2.191-4.89-4.891v-12.613c0-2.974,2.858-5.569,5.691-4.785
              l26.243,7.123c1.334,0.361,2.258,1.573,2.258,2.95c0,2.509-1.903,4.584-4.339,4.859L332.708,253.08z M381.362,364.892
              c-22.326,0-40.49-18.164-40.49-40.484c0-22.325,18.164-40.489,40.49-40.489c22.325,0,40.489,18.164,40.489,40.489
              C421.852,346.728,403.688,364.892,381.362,364.892z M419.202,267.137c-14.327,0-25.986-11.658-25.986-25.985
              s11.659-25.985,25.986-25.985c14.326,0,25.985,11.658,25.985,25.985C445.182,255.479,433.528,267.137,419.202,267.137z
              M465.824,313.759c-14.327,0-25.985-11.658-25.985-25.985s11.658-25.985,25.985-25.985c14.326,0,25.985,11.658,25.985,25.985
              C491.804,302.101,480.15,313.759,465.824,313.759z M512.446,267.137c-14.327,0-25.985-11.658-25.985-25.985
              s11.658-25.985,25.985-25.985s25.985,11.658,25.985,25.985C538.426,255.479,526.772,267.137,512.446,267.137z"
              />
              <path
                d="M270.437,203.63c1.407,0.997,2.993,1.444,4.541,1.462c1.181,0,2.167-0.171,3.103-0.52
              c0.067-0.024,0.116-0.074,0.184-0.099c0.012-0.006,0.031,0,0.043-0.006c1.334-0.502,2.466-1.279,3.292-2.454
              c1.114-1.579,1.377-3.292,0.704-5.116c-0.472-1.279-1.334-2.265-2.473-2.986c-0.563-0.355-1.138-0.631-1.72-0.839
              c-1.806-0.703-3.703-0.74-5.667-0.11c-1.396,0.447-2.577,1.236-3.464,2.412c-1.193,1.585-1.53,3.341-0.888,5.232
              C268.527,201.874,269.353,202.859,270.437,203.63z"
              />
  
              <circle
                cx="290.000"
                cy="295.000"
                r="35"
                width="50.898"
                height="100.711"
                stroke="black"
                fill="black"
              />
              <rect
                x="227.994"
                y="190.0"
                width="120.898"
                height="17.5"
                stroke="black"
                fill="black"
              />
  
              <rect
                id="controller-b4"
                x="83.5"
                y="110.0"
                width="70"
                height="20"
                rx="16.5"
                stroke-width="3"
              ></rect>
              <rect
                id="controller-b5"
                x="429.5"
                y="110.0"
                width="70"
                height="20"
                rx="16.5"
                stroke-width="3"
              ></rect>
  
              <rect
                id="controller-b6"
                x="99.994"
                y="50.0"
                height="50.898"
                width="35.5"
                fill="black"
                rx="19"
                ry="10"
              />
  
              <rect
                id="controller-b7"
                x="448.994"
                y="50.0"
                height="50.898"
                width="35.5"
                fill="black"
                rx="19"
                ry="10"
              />
  
              <circle
                id="controller-b10-below"
                name="left-stick"
                cx="200.000"
                cy="325.000"
                data-original-x-position="200.000"
                data-original-y-position="325.000"
                r="15"
                width="50.898"
                height="100.711"
                stroke="black"
                fill="black"
              />
  
              <circle
                id="controller-b10"
                name="left-stick"
                cx="200.000"
                cy="325.000"
                data-original-x-position="200.000"
                data-original-y-position="325.000"
                r="35"
                width="50.898"
                height="100.711"
                fill="rgb(105, 4, 4)"
              />
  
              <circle
                id="controller-b11-bottom"
                name="stick-right"
                cx="381.000"
                cy="325.000"
                data-original-x-position="381.000"
                data-original-y-position="325.000"
                r="15"
                width="50.898"
                height="100.711"
                stroke="black"
                fill="black"
              />
  
              <circle
                id="controller-b11"
                name="stick-right"
                cx="381.000"
                cy="325.000"
                data-original-x-position="381.000"
                data-original-y-position="325.000"
                r="35"
                width="50.898"
                height="100.711"
                fill="rgb(105, 4, 4)"
              />
            </g>
          </g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
        </svg>
    </div>
        

		<div class="slider-container">
			<div class="joystick-heading">Slider 1</div>
			<input id="slider" class="slider" type="range" min="0" max="100" step="1" value="0">
			<span id="sliderValue">0</span>
		</div>
		
		<div class="slider-container">
			<div class="joystick-heading">Toggle Switch 1</div>
			<button id="zoomButton" class="toggle-button"></button>
			<span id="zoomValue">0</span>
		</div>

		<script type="text/javascript">

      // start from here

      let StickStatus =
{
    xPosition: 0,
    yPosition: 0,
    x: 0,
    y: 0,
    cardinalDirection: "C"
};

/**
 * @desc Principal object that draw a joystick, you only need to initialize the object and suggest the HTML container
 * @costructor
 * @param container {String} - HTML object that contains the Joystick
 * @param parameters (optional) - object with following keys:
 *  title {String} (optional) - The ID of canvas (Default value is 'joystick')
 *  width {Int} (optional) - The width of canvas, if not specified is setted at width of container object (Default value is the width of container object)
 *  height {Int} (optional) - The height of canvas, if not specified is setted at height of container object (Default value is the height of container object)
 *  internalFillColor {String} (optional) - Internal color of Stick (Default value is '#00AA00')
 *  internalLineWidth {Int} (optional) - Border width of Stick (Default value is 2)
 *  internalStrokeColor {String}(optional) - Border color of Stick (Default value is '#003300')
 *  externalLineWidth {Int} (optional) - External reference circonference width (Default value is 2)
 *  externalStrokeColor {String} (optional) - External reference circonference color (Default value is '#008000')
 *  autoReturnToCenter {Bool} (optional) - Sets the behavior of the stick, whether or not, it should return to zero position when released (Default value is True and return to zero)
 * @param callback {StickStatus} - 
 */
var JoyStick = (function(container, parameters, callback)
{
    parameters = parameters || {};
    var title = (typeof parameters.title === "undefined" ? "joystick" : parameters.title),
        width = (typeof parameters.width === "undefined" ? 0 : parameters.width),
        height = (typeof parameters.height === "undefined" ? 0 : parameters.height),
        internalFillColor = (typeof parameters.internalFillColor === "undefined" ? "#00AA00" : parameters.internalFillColor),
        internalLineWidth = (typeof parameters.internalLineWidth === "undefined" ? 2 : parameters.internalLineWidth),
        internalStrokeColor = (typeof parameters.internalStrokeColor === "undefined" ? "#003300" : parameters.internalStrokeColor),
        externalLineWidth = (typeof parameters.externalLineWidth === "undefined" ? 2 : parameters.externalLineWidth),
        externalStrokeColor = (typeof parameters.externalStrokeColor ===  "undefined" ? "#008000" : parameters.externalStrokeColor),
        autoReturnToCenter = (typeof parameters.autoReturnToCenter === "undefined" ? true : parameters.autoReturnToCenter);

    callback = callback || function(StickStatus) {};

    // Create Canvas element and add it in the Container object
    var objContainer = document.getElementById(container);
    
    // Fixing Unable to preventDefault inside passive event listener due to target being treated as passive in Chrome [Thanks to https://github.com/artisticfox8 for this suggestion]
    objContainer.style.touchAction = "none";

    var canvas = document.createElement("canvas");
    canvas.id = title;
    if(width === 0) { width = objContainer.clientWidth; }
    if(height === 0) { height = objContainer.clientHeight; }
    canvas.width = width;
    canvas.height = height;
    objContainer.appendChild(canvas);
    var context=canvas.getContext("2d");

    var pressed = 0; // Bool - 1=Yes - 0=No
    var circumference = 2 * Math.PI;
    var internalRadius = (canvas.width-((canvas.width/2)+10))/2;
    var maxMoveStick = internalRadius + 5;
    var externalRadius = internalRadius + 30;
    var centerX = canvas.width / 2;
    var centerY = canvas.height / 2;
    var directionHorizontalLimitPos = canvas.width / 10;
    var directionHorizontalLimitNeg = directionHorizontalLimitPos * -1;
    var directionVerticalLimitPos = canvas.height / 10;
    var directionVerticalLimitNeg = directionVerticalLimitPos * -1;
    // Used to save current position of stick
    var movedX=centerX;
    var movedY=centerY;

    // Check if the device support the touch or not
    if("ontouchstart" in document.documentElement)
    {
        canvas.addEventListener("touchstart", onTouchStart, false);
        document.addEventListener("touchmove", onTouchMove, false);
        document.addEventListener("touchend", onTouchEnd, false);
    }
    else
    {
        canvas.addEventListener("mousedown", onMouseDown, false);
        document.addEventListener("mousemove", onMouseMove, false);
        document.addEventListener("mouseup", onMouseUp, false);
    }
    // Draw the object
    drawExternal();
    drawInternal();

    /******************************************************
     * Private methods
     *****************************************************/

    /**
     * @desc Draw the external circle used as reference position
     */
    function drawExternal()
    {
        context.beginPath();
        context.arc(centerX, centerY, externalRadius, 0, circumference, false);
        context.lineWidth = externalLineWidth;
        context.strokeStyle = externalStrokeColor;
        context.stroke();
    }

    /**
     * @desc Draw the internal stick in the current position the user have moved it
     */
    function drawInternal()
    {
        context.beginPath();
        if(movedX<internalRadius) { movedX=maxMoveStick; }
        if((movedX+internalRadius) > canvas.width) { movedX = canvas.width-(maxMoveStick); }
        if(movedY<internalRadius) { movedY=maxMoveStick; }
        if((movedY+internalRadius) > canvas.height) { movedY = canvas.height-(maxMoveStick); }
        context.arc(movedX, movedY, internalRadius, 0, circumference, false);
        // create radial gradient
        var grd = context.createRadialGradient(centerX, centerY, 5, centerX, centerY, 200);
        // Light color
        grd.addColorStop(0, internalFillColor);
        // Dark color
        grd.addColorStop(1, internalStrokeColor);
        context.fillStyle = grd;
        context.fill();
        context.lineWidth = internalLineWidth;
        context.strokeStyle = internalStrokeColor;
        context.stroke();
    }

    /**
     * @desc Events for manage touch
     */
    function onTouchStart(event) 
    {
        pressed = 1;
    }

    function onTouchMove(event)
    {
        if(pressed === 1 && event.targetTouches[0].target === canvas)
        {
            movedX = event.targetTouches[0].pageX;
            movedY = event.targetTouches[0].pageY;
            // Manage offset
            if(canvas.offsetParent.tagName.toUpperCase() === "BODY")
            {
                movedX -= canvas.offsetLeft;
                movedY -= canvas.offsetTop;
            }
            else
            {
                movedX -= canvas.offsetParent.offsetLeft;
                movedY -= canvas.offsetParent.offsetTop;
            }
            // Delete canvas
            context.clearRect(0, 0, canvas.width, canvas.height);
            // Redraw object
            drawExternal();
            drawInternal();

            // Set attribute of callback
            StickStatus.xPosition = movedX;
            StickStatus.yPosition = movedY;
            StickStatus.x = (100*((movedX - centerX)/maxMoveStick)).toFixed();
            StickStatus.y = ((100*((movedY - centerY)/maxMoveStick))*-1).toFixed();
            StickStatus.cardinalDirection = getCardinalDirection();
            callback(StickStatus);
        }
    } 

    function onTouchEnd(event) 
    {
        pressed = 0;
        // If required reset position store variable
        if(autoReturnToCenter)
        {
            movedX = centerX;
            movedY = centerY;
        }
        // Delete canvas
        context.clearRect(0, 0, canvas.width, canvas.height);
        // Redraw object
        drawExternal();
        drawInternal();

        // Set attribute of callback
        StickStatus.xPosition = movedX;
        StickStatus.yPosition = movedY;
        StickStatus.x = (100*((movedX - centerX)/maxMoveStick)).toFixed();
        StickStatus.y = ((100*((movedY - centerY)/maxMoveStick))*-1).toFixed();
        StickStatus.cardinalDirection = getCardinalDirection();
        callback(StickStatus);
    }

    /**
     * @desc Events for manage mouse
     */
    function onMouseDown(event) 
    {
        pressed = 1;
    }

    function onMouseMove(event) 
    {
        if(pressed === 1)
        {
            movedX = event.pageX;
            movedY = event.pageY;
            // Manage offset
            if(canvas.offsetParent.tagName.toUpperCase() === "BODY")
            {
                movedX -= canvas.offsetLeft;
                movedY -= canvas.offsetTop;
            }
            else
            {
                movedX -= canvas.offsetParent.offsetLeft;
                movedY -= canvas.offsetParent.offsetTop;
            }
            // Delete canvas
            context.clearRect(0, 0, canvas.width, canvas.height);
            // Redraw object
            drawExternal();
            drawInternal();

            // Set attribute of callback
            StickStatus.xPosition = movedX;
            StickStatus.yPosition = movedY;
            StickStatus.x = (100*((movedX - centerX)/maxMoveStick)).toFixed();
            StickStatus.y = ((100*((movedY - centerY)/maxMoveStick))*-1).toFixed();
            StickStatus.cardinalDirection = getCardinalDirection();
            callback(StickStatus);
        }
    }

    function onMouseUp(event) 
    {
        pressed = 0;
        // If required reset position store variable
        if(autoReturnToCenter)
        {
            movedX = centerX;
            movedY = centerY;
        }
        // Delete canvas
        context.clearRect(0, 0, canvas.width, canvas.height);
        // Redraw object
        drawExternal();
        drawInternal();

        // Set attribute of callback
        StickStatus.xPosition = movedX;
        StickStatus.yPosition = movedY;
        StickStatus.x = (100*((movedX - centerX)/maxMoveStick)).toFixed();
        StickStatus.y = ((100*((movedY - centerY)/maxMoveStick))*-1).toFixed();
        StickStatus.cardinalDirection = getCardinalDirection();
        callback(StickStatus);
    }

    function getCardinalDirection()
    {
        let result = "";
        let orizontal = movedX - centerX;
        let vertical = movedY - centerY;
        
        if(vertical >= directionVerticalLimitNeg && vertical <= directionVerticalLimitPos)
        {
            result = "C";
        }
        if(vertical < directionVerticalLimitNeg)
        {
            result = "N";
        }
        if(vertical > directionVerticalLimitPos)
        {
            result = "S";
        }
        
        if(orizontal < directionHorizontalLimitNeg)
        {
            if(result === "C")
            { 
                result = "W";
            }
            else
            {
                result += "W";
            }
        }
        if(orizontal > directionHorizontalLimitPos)
        {
            if(result === "C")
            { 
                result = "E";
            }
            else
            {
                result += "E";
            }
        }
        
        return result;
    }

    // let controllerIndex = null;

    // window.addEventListener("gamepadconnected", (event) => {
    // handleConnectDisconnect(event, true);
    // });

    // window.addEventListener("gamepaddisconnected", (event) => {
    // handleConnectDisconnect(event, false);
    // });

    // function handleConnectDisconnect(event, connected) {
    // const controllerAreaNotConnected = document.getElementById(
    //     "controller-not-connected-area"
    // );
    // const controllerAreaConnected = document.getElementById(
    //     "controller-connected-area"
    // );

    // const gamepad = event.gamepad;
    // console.log(gamepad);

    // if (connected) {
    //     controllerIndex = gamepad.index;
    //     controllerAreaNotConnected.style.display = "none";
    //     controllerAreaConnected.style.display = "block";
    //     createButtonLayout(gamepad.buttons);
    //     createAxesLayout(gamepad.axes);
    // } else {
    //     controllerIndex = null;
    //     controllerAreaNotConnected.style.display = "block";
    //     controllerAreaConnected.style.display = "none";
    // }
    // }

    // function createAxesLayout(axes) {
    //     const buttonsArea = document.getElementById("buttons");
    //     for (let i = 0; i < axes.length; i++) {
    //         buttonsArea.innerHTML += `<div id=axis-${i} class='axis'>
    //                                     <div class='axis-name'>AXIS ${i}</div>
    //                                     <div class='axis-value'>${axes[i].toFixed(
    //                                         4
    //                                     )}</div>
    //                                 </div> `;
    //     }
    // }

    // function createButtonLayout(buttons) {
    //     const buttonArea = document.getElementById("buttons");
    //     buttonArea.innerHTML = "";
    //     for (let i = 0; i < buttons.length; i++) {
    //     buttonArea.innerHTML += createButtonHtml(i, 0);
    //     }
    // }
    
    // function createButtonHtml(index, value) {
    //     return `<div class="button" id="button-${index}">
    //                 <svg width="10px" height="50px">
    //                     <rect width="10px" height="50px" fill="grey"></rect>
    //                     <rect
    //                         class="button-meter"
    //                         width="10px"
    //                         x="0"
    //                         y="50"
    //                         data-original-y-position="50"
    //                         height="50px"
    //                         fill="rgb(60, 61, 60)"
    //                     ></rect>
    //                 </svg>
    //                 <div class='button-text-area'>
    //                     <div class="button-name">B${index}</div>
    //                     <div class="button-value">${value.toFixed(2)}</div>
    //                 </div>
    //             </div>`;
    // }

    // function updateButtonOnGrid(index, value) {
    //     const buttonArea = document.getElementById(`button-${index}`);
    //     const buttonValue = buttonArea.querySelector(".button-value");
    //     buttonValue.innerHTML = value.toFixed(2);
    
    //     const buttonMeter = buttonArea.querySelector(".button-meter");
    //     const meterHeight = Number(buttonMeter.dataset.originalYPosition);
    //     const meterPosition = meterHeight - (meterHeight / 100) * (value * 100);
    //     buttonMeter.setAttribute("y", meterPosition);
    // }
    
    // function updateControllerButton(index, value) {
    //     const button = document.getElementById(`controller-b${index}`);
    //     const selectedButtonClass = "selected-button";
    //     1;
    //     if (button) {
    //         if (value > 0) {
    //         button.classList.add(selectedButtonClass);
    //         button.style.filter = `contrast(${value * 200}%)`;
    //         } else {
    //         button.classList.remove(selectedButtonClass);
    //         button.style.filter = `contrast(100%)`;
    //         }
    //     }
    // }

    // function handleButtons(buttons) {
    //     for (let i = 0; i < buttons.length; i++) {
    //         const buttonValue = buttons[i].value;
    //         updateButtonOnGrid(i, buttonValue);
    //         updateControllerButton(i, buttonValue);
    //     }
    // }

    // function handleSticks(axes) {
    //     updateAxesGrid(axes);
    //     updateStick("controller-b10", axes[0], axes[1]);
    //     updateStick("controller-b11", axes[2], axes[3]);
    // }

    // function updateAxesGrid(axes) {
    //     for (let i = 0; i < axes.length; i++) {
    //         const axis = document.querySelector(`#axis-${i} .axis-value`);
    //         const value = axes[i];
    //         // if (value > 0.06 || value < -0.06) {
    //         axis.innerHTML = value.toFixed(4);
    //         // }
    //     }
    // }

    // function updateStick(elementId, leftRightAxis, upDownAxis) {
    //     const multiplier = 25;
    //     const stickLeftRight = leftRightAxis * multiplier;
    //     const stickUpDown = upDownAxis * multiplier;

    //     const stick = document.getElementById(elementId);
    //     const x = Number(stick.dataset.originalXPosition);
    //     const y = Number(stick.dataset.originalYPosition);

    //     stick.setAttribute("cx", x + stickLeftRight);
    //     stick.setAttribute("cy", y + stickUpDown);

    // }

    // function handleRumble(gamepad) {
    //     const rumbleOnButtonPress = document.getElementById("rumble-on-button-press");

    //     if (rumbleOnButtonPress.checked) {
    //         if (gamepad.buttons.some((button) => button.value > 0)) {
    //         gamepad.vibrationActuator.playEffect("dual-rumble", {
    //             startDelay: 0,
    //             duration: 25,
    //             weakMagnitude: 1.0,
    //             strongMagnitude: 1.0,
    //         });
    //         }
    //     }
    // }

    // // function controllerInput() {
    // //     if (controllerIndex !== null){
    // //         const gamepad = navigator.getGamepads()[controllerIndex];
            
    // //         const buggy_left_right = gamepad.axes[0];
    // //         sendDataToServerNewLeftLeftRight();
    // //         const buggy_up_down = gamepad.axes[1];
    // //         sendDataToServerNewLeftUpDown();
    // //         const camera_left_right = gamepad.axes[2];
    // //         sendDataToServerNewRightLeftRight();
    // //         const camera_up_down = gamepad.axes[3];
    // //         sendDataToServerNewRightUpDown();

    // //     }
    // // }

    // function gameLoop() {
    //     if (controllerIndex !== null) {
    //         const gamepad = navigator.getGamepads()[controllerIndex];
    //         handleButtons(gamepad.buttons);
    //         handleSticks(gamepad.axes);
    //         handleRumble(gamepad);
    //         // controllerInput();
            
    //         const buggy_left_right = gamepad.axes[0];
    //         // sendDataToServerNewLeftLeftRight();
    //         const buggy_up_down = gamepad.axes[1];
    //         // sendDataToServerNewLeftUpDown();
    //         const camera_left_right = gamepad.axes[2];
    //         // sendDataToServerNewRightLeftRight();
    //         const camera_up_down = gamepad.axes[3];
    //         // sendDataToServerNewRightUpDown();
    //         // console.log("buggy left right: ", buggy_left_right);

    //         console.log(buggy_left_right);
    //         console.log(buggy_up_down);
    //         console.log(camera_left_right);
    //         console.log(camera_up_down);
                

    //     }
    //     requestAnimationFrame(gameLoop);
    // }

    // // setTimeout(gameLoop(),2000);
    // window.requestAnimationFrame(gameLoop)


    /******************************************************
     * Public methods
     *****************************************************/

    /**
     * @desc The width of canvas
     * @return Number of pixel width 
     */
    this.GetWidth = function () 
    {
        return canvas.width;
    };

    /**
     * @desc The height of canvas
     * @return Number of pixel height
     */
    this.GetHeight = function () 
    {
        return canvas.height;
    };

    /**
     * @desc The X position of the cursor relative to the canvas that contains it and to its dimensions
     * @return Number that indicate relative position
     */
    this.GetPosX = function ()
    {
        return movedX;
    };

    /**
     * @desc The Y position of the cursor relative to the canvas that contains it and to its dimensions
     * @return Number that indicate relative position
     */
    this.GetPosY = function ()
    {
        return movedY;
    };

    /**
     * @desc Normalizzed value of X move of stick
     * @return Integer from -100 to +100
     */
    this.GetX = function ()
    {
        return (100*((movedX - centerX)/maxMoveStick)).toFixed();
    };

    /**
     * @desc Normalizzed value of Y move of stick
     * @return Integer from -100 to +100
     */
    this.GetY = function ()
    {
        return ((100*((movedY - centerY)/maxMoveStick))*-1).toFixed();
    };

    /**
     * @desc Get the direction of the cursor as a string that indicates the cardinal points where this is oriented
     * @return String of cardinal point N, NE, E, SE, S, SW, W, NW and C when it is placed in the center
     */
    this.GetDir = function()
    {
        return getCardinalDirection();
    };
});
  
// end here

			function sendDataToServer(stickData) {
				fetch("/joystick_data", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify(stickData),
				})
				.then((response) => response.text())
				.then((data) => console.log(data))
				.catch((error) => console.error(error));
			}
			// Create JoyStick object into the DIV 'joy1Div'
			// var joy1Param = {"autoReturnToCenter": false };
      var throttle = 0;
      var yaw = 0;
      var pitch = 0;
      var roll = 0;
      var slider_1 = 0;
      var slider_2 = 0;
      var zoom_value = 0;
      var toggle_2 = 0;

      var throttle_value = 0;
      var yaw_value = 0;
      var pitch_value = 0;
      var roll_value = 0;
      var slider_1_value = 0;
      var slider_2_value = 0;
      var zoom_value = 0;
      var toggle_2_value = 0;

      let data_to_send = "5";

      // start
      // program to implement stack data structure
      class Stack {
        constructor() {
            this.items = [];
        }
        
        // add element to the stack
        add(element) {
            return this.items.push(element);
        }
        
        // remove element from the stack
        remove() {
            if(this.items.length > 0) {
                return this.items.pop();
            }
        }
        
        // view the last element
        peek() {
            return this.items[this.items.length - 1];
        }
        
        // check if the stack is empty
        isEmpty(){
          return this.items.length == 0;
        }
      
        // the size of the stack
        size(){
            return this.items.length;
        }

        // empty the stack
        clear(){
            this.items = [];
        }
      }

      let stack = new Stack();
      stack.add(0);

      function send_rc_values(throttle, yaw, roll, pitch, slider_1, slider_2, zoom_value, toggle_2){

        //data_to_send = f"REMOTE,{roll_value},{pitch_value},{throttle_value},{yaw_value},{toggle_1_value},{slider_1_value},{toggle_2_value},{slider_2_value}\n"

        roll_value = roll;
        pitch_value = pitch;
        throttle_value = throttle;
        yaw_value = yaw;
        toggle_1_value = zoom_value;
        slider_1_value = slider_1;
        toggle_2_value = toggle_2;
        slider_2_value = slider_2;

        if (slider_1_value === 0){
          slider_1_value = stack.items[stack.size() - 1];
        }
        /*else{
          slider_1_value = stack.items[stack.size() - 1];
        }*/

        //stack.add(slider_1_value);
        //slider_1_value = stack.items[stack.size() - 2];

        data_to_send = "REMOTE,"+roll_value+","+pitch_value+","+throttle_value+","+yaw_value+","+toggle_1_value+","+slider_1_value+","+toggle_2_value+","+slider_2_value+'k';
        
        //data_to_send = "yash"+'k';

        //data_to_send = "Yash Wmbre";

        socket.emit('lights', { "status":data_to_send });

        //console.log(data_to_send);
      }

			var Joy1 = new JoyStick('joy1Div', {}, function(stickData) {
				stickData.x = parseInt(stickData.x); // Convert to integer
				stickData.y = parseInt(stickData.y); // Convert to integer
				document.getElementById("joy1Div").value = stickData.joyname;
				document.getElementById("joy1PosizioneX").value = stickData.xPosition;
				document.getElementById("joy1PosizioneY").value = stickData.yPosition;
				document.getElementById("joy1Direzione").value = getDirectionDescription(stickData.cardinalDirection, stickData.x, stickData.y);
				document.getElementById("joy1X").value = stickData.x;
				document.getElementById("joy1Y").value = stickData.y;
				sendDataToServer({"joy1Div": stickData});
        throttle = stickData.y;
        yaw = stickData.x;

        if (yaw > 0 && throttle > 0){
          yaw = ((Math.sqrt(yaw*yaw*yaw)) / 10);
          throttle = ((Math.sqrt(throttle*throttle*throttle)) / 10);
        }
        else if (yaw < 0 && throttle < 0){
          yaw = -1 * yaw;
          throttle = -1 * throttle;
          yaw = -1 * ((Math.sqrt(yaw*yaw*yaw)) / 10);
          throttle = -1 * ((Math.sqrt(throttle*throttle*throttle)) / 10);
        }
        else if (yaw > 0 && throttle < 0){
          throttle = -1 * throttle;
          yaw = ((Math.sqrt(yaw*yaw*yaw)) / 10);
          throttle = -1 * ((Math.sqrt(throttle*throttle*throttle)) / 10);
        }
        else if (yaw < 0 && throttle > 0){
          yaw = -1 * yaw;
          yaw = -1 * ((Math.sqrt(yaw*yaw*yaw)) / 10);
          throttle = ((Math.sqrt(throttle*throttle*throttle)) / 10);
        }

        yaw = map_value(yaw, -100, 100, 170, 1811); // 170 and 1811
        throttle = map_value(throttle, -100, 100, 170, 1811);
        
        yaw = Math.trunc(yaw);
        throttle = Math.trunc(throttle);

        send_rc_values(throttle, yaw, roll, pitch, slider_1, slider_2, zoom_value, toggle_2);
			});
			// Create JoyStick object into the DIV 'joy2Div'
			var Joy2 = new JoyStick('joy2Div', {}, function(stickData) {
				stickData.x = parseInt(stickData.x); // Convert to integer
				stickData.y = parseInt(stickData.y); // Convert to integer
				document.getElementById("joy2Div").value = stickData.joyname;
				document.getElementById("joy2PosizioneX").value = stickData.xPosition;
				document.getElementById("joy2PosizioneY").value = stickData.yPosition;
				document.getElementById("joy2Direzione").value = getDirectionDescription(stickData.cardinalDirection, stickData.x, stickData.y);
				document.getElementById("joy2X").value = stickData.x;
				document.getElementById("joy2Y").value = stickData.y;
				sendDataToServer({"joy2Div": stickData});
        pitch = stickData.y;
        roll = stickData.x;

        if (roll > 0 && pitch > 0){
          roll = ((Math.sqrt(roll*roll*roll)) / 10);
          pitch = ((Math.sqrt(pitch*pitch*pitch)) / 10);
        }
        else if (roll < 0 && pitch < 0){
          roll = -1 * roll;
          pitch = -1 * pitch;
          roll = -1 * ((Math.sqrt(roll*roll*roll)) / 10);
          pitch = -1 * ((Math.sqrt(pitch*pitch*pitch)) / 10);
        }
        else if (roll > 0 && pitch < 0){
          pitch = -1 * pitch;
          roll = ((Math.sqrt(roll*roll*roll)) / 10);
          pitch = -1 * ((Math.sqrt(pitch*pitch*pitch)) / 10);
        }
        else if (pitch > 0 && roll < 0){
          roll = -1 * roll;
          roll = -1 * ((Math.sqrt(roll*roll*roll)) / 10);
          pitch = ((Math.sqrt(pitch*pitch*pitch)) / 10);
        }

        pitch = map_value(pitch, -100, 100, 170, 1811);
        roll = map_value(roll, -100, 100, 170, 1811);

        pitch = Math.trunc(pitch);
        roll = Math.trunc(roll);

        send_rc_values(throttle, yaw, roll, pitch, slider_1, slider_2, zoom_value, toggle_2)
			});


        // Get references to the slider and its value display element
      var slider = document.getElementById("slider");
      var sliderValue = document.getElementById("sliderValue");
      var slider1 = 0;
      var slider_1_mapped = 1810;
      var slider2 = 0;
      var slider_2_mapped = 0;

      // Add an event listener to track slider value changes
      slider.addEventListener("input", function() {
          var value = slider.value;
          //console.log(value);
          sliderValue.textContent = value; // Display the current value
          sendSliderValueToServer(value); // Send the value to the server if needed
          //slider_1 = int(value);
          slider_1_mapped = map_value(value, 0, 100, 170, 1810);
          slider_1_mapped = Math.trunc(slider_1_mapped);
          //console.log("MY NAME IS");
          stack.add(slider_1_mapped);
          //slider_1_mapped = stack.items[stack.size() - 1];
          send_slider_values(slider_1_mapped, slider_2_mapped);
          //console.log("YASH AMBRE");
          //send_rc_values(throttle, yaw, roll, pitch, slider_1_mapped, slider_2, zoom_value, toggle_2);

      });

        // Get references to the new slider and its value display element
      var slider2 = document.getElementById("slider2");
      var sliderValue2 = document.getElementById("sliderValue2");

      // Add an event listener to track slider2 value changes
      slider2.addEventListener("input", function() {
          var value2 = slider2.value;
          sliderValue2.textContent = value2; // Display the current value
          sendSlider2ValueToServer(value2); // Send the value to the server if needed
          //slider_2 = int(value2);
          slider_2_mapped = map_value(value2, 0, 100, 170, 1810);
          slider_2_mapped = Math.trunc(slider_2_mapped);
          send_slider_values(slider_1_mapped, slider_2_mapped);
          //send_rc_values(throttle, yaw, roll, pitch, slider_1_mapped, slider_2_mapped, zoom_value, toggle_2);
      });

      function send_slider_values(slider_1_mapped, slider_2_mapped){
        //console.log("YASH AMBRE");
        send_rc_values(throttle, yaw, roll, pitch, slider_1_mapped, slider_2_mapped, zoom_value, toggle_2);
      }

        // Toggle switch button event listener for the new toggle switch
        var toggleButton2 = document.getElementById("toggleButton2");
        var toggleValue2 = document.getElementById("toggleValue2");
        var toggleState2 = false;
        var toggle2 = 0;
        var toggle_2_mapped = 0;

        toggleButton2.addEventListener("click", function() {
            toggleState2 = !toggleState2;
            var value2 = toggleState2 ? 100 : 0;
            toggleValue2.textContent = value2;
            toggle2 = int(value2);
            toggle_2_mapped = map_value(toggle2, 0, 100, 0, 2000)
            send_rc_values(throttle, yaw, roll, pitch, slider_1_mapped, slider_2_mapped, zoom_value, toggle_2_mapped);
            //sendToggle2ToServer(value2);
            updateToggle2ButtonStyle();
        });

        function updateToggle2ButtonStyle() {
            if (toggleState2) {
                toggleButton2.classList.add("active");
            } else {
                toggleButton2.classList.remove("active");
            }
        }

        // Initialize the toggle2 value and button style
        toggleValue2.textContent = "0";
        updateToggle2ButtonStyle();

        function sendSlider2ValueToServer(sliderValue2) {
            fetch("/slider2_data", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ sliderValue2: sliderValue2 }),
            })
            .then((response) => response.text())
            .then((data) => console.log(data))
            .catch((error) => console.error(error));
        }

        function sendToggle2ToServer(toggleValue2) {
            fetch("/toggle2_data", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ toggleValue2: toggleValue2 }),
            })
            .then((response) => response.text())
            .then((data) => console.log(data))
            .catch((error) => console.error(error));
        }

        function getDirectionDescription(cardinalDirection, x, y) {
            if (cardinalDirection === "N") {
                return "forward";
            } else if (cardinalDirection === "S") {
                return "backward";
            } else if (cardinalDirection === "E") {
                return "right";
            } else if (cardinalDirection === "W") {
                return "left";
            } else if (x !== 0) {
                return "pan";
            } else if (y !== 0) {
                return "tilt";
            } else {
                return "neutral";
            }
        }
        // Toggle switch button event listener
        var zoomButton = document.getElementById("zoomButton");
        var zoomValue = document.getElementById("zoomValue");
        var zoomState = false;

        zoomButton.addEventListener("click", function() {
            zoomState = !zoomState;
            var value = zoomState ? 100 : 0;
            zoomValue.textContent = value;
            sendZoomToServer(value);
            updateButtonStyle();
        });

        function updateButtonStyle() {
            if (zoomState) {
                zoomButton.classList.add("active");
            } else {
                zoomButton.classList.remove("active");
            }
        }

        // Initialize the zoom value and button style
        zoomValue.textContent = "0";
        updateButtonStyle();

        function sendZoomToServer(zoomValue) {
            fetch("/zoom_data", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ zoom: zoomValue }),
            })
            .then((response) => response.text())
            .then((data) => console.log(data))
            .catch((error) => console.error(error));
        }

        function sendSliderValueToServer(sliderValue) {
            fetch("/slider_data", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ sliderValue: sliderValue }),
            })
            .then((response) => response.text())
            .then((data) => console.log(data))
            .catch((error) => console.error(error));
        }

        var upcam = false;
        var rightcam = false;
        var downcam = false;
        var leftcam = false;

        var frontbug = false;
        var rightbug = false;
        //var backbug = false;
        var leftbug = false;

        var xbug = 0
        var ybug = 0
        var xcam = 0
        var ycam = 0

        document.addEventListener('keydown',press)
        function press(e){
            if (e.keyCode === 38 /* up */){
              upcam = true
            }
            if (e.keyCode === 87 /*w*/){
                frontbug = true
            }
            if (e.keyCode === 39 /* right */){
              rightcam = true
            }
            if (e.keyCode === 68 /*d*/){
                rightbug = true
            }
            if (e.keyCode === 40 /* down */){
              downcam = true
            }
            /*if (e.keyCode === 83){
                backbug = true
            }*/
            if (e.keyCode === 37 /* left */){
              leftcam = true
            }
            if (e.keyCode === 65 /*a*/){
                leftbug = true
            }

            if (upcam==true || downcam==true || rightcam==true || leftcam==true || frontbug==true || rightbug==true || leftbug==true || -100<= ycam <=100 || -100<= xcam <=100 || -100<= ybug <=100 || -100<= xbug <=100){
                gameLoop();
            }
        }

        document.addEventListener('keyup',release)
        function release(e){
            if (e.keyCode === 38 /* up */){
                upcam = false
                ycam = 0
              }
              if (e.keyCode === 87 /*w*/){
                  frontbug = false
                  ybug = 0
              }
              if (e.keyCode === 39 /* right */){
                rightcam = false
                xcam = 0
              }
              if (e.keyCode === 68 /*d*/){
                  rightbug = false
                  xbug = 0
              }
              if (e.keyCode === 40 /* down */){
                downcam = false
                ycam = 0
              }
              /*if (e.keyCode === 83){
                  backbug = false
              }*/
              if (e.keyCode === 37 /* left */){
                leftcam = false
                xcam = 0
              }
              if (e.keyCode === 65 /*a*/){
                  leftbug = false
                  xbug = 0
              }
              if (upcam==false || downcam==false || rightcam==false || leftcam==false || frontbug==false || rightbug==false || leftbug==false){
                gameLoop();
            }
        }

        function gameLoop(){
            if (frontbug === true && ybug <= 100){
                ybug = ybug + 1
            }
            if (rightbug === true && xbug <= 100){
                xbug = xbug + 1
            }
            /*if (backbug === true && ybug >= -100){
                ybug = ybug - 1
            }*/
            if (leftbug === true && ybug >= -100){
                xbug = xbug - 1
            }


            if (upcam === true && ycam <= 100){
                ycam = ycam + 1
            }
            if (rightcam === true && xcam <= 100){
                xcam = xcam + 1
            }
            if (downcam === true && ycam >= -100){
                ycam = ycam - 1
            }
            if (leftcam === true && ycam >= -100){
                xcam = xcam - 1
            }

            var buggy_front_back = ybug;
            var buggy_left_right = xbug;
            var camera_up_down = ycam;
            var camera_left_right = xcam

            /*sendDataToServerNewbugleftright(buggy_left_right);
            sendDataToServerNewbugfrontback(buggy_front_back);
            sendDataToServerNewcameraleftright(camera_left_right);
            sendDataToServerNewcameraupdown(camera_up_down);*/


            //window.requestAnimationFrame(gameLoop);
        }
        //window.requestAnimationFrame(gameLoop);


        // function controllerInput() {
        //     if (controllerIndex !== null){
        //         const gamepad = navigator.getGamepads()[controllerIndex];
                
        //         const buggy_left_right = gamepad.axes[0];
        //         sendDataToServerNewLeftLeftRight();
        //         const buggy_up_down = gamepad.axes[1];
        //         sendDataToServerNewLeftUpDown();
        //         const camera_left_right = gamepad.axes[2];
        //         sendDataToServerNewRightLeftRight();
        //         const camera_up_down = gamepad.axes[3];
        //         sendDataToServerNewRightUpDown();

        //     }
        // }

        /*function sendDataToServerNewbugleftright(buggy_left_right) {
            //ocument.getElementById('controller-b10').innerHTML = buggy_left_right;
            //var value = document.getElementById('controller-b10').innerHTML;
            //var stick_data_new_left_left_right = {"a": buggy_left_right};
                    fetch("/joystick_data_new", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({"a": buggy_left_right}),
                    })
                    .then((response) => response.text())
                    .then((data) => console.log(data))
                    .catch((error) => console.error(error));
                }*/
        
          /*function sendDataToServerNewbugfrontback(buggy_front_back) {
            //document.getElementById('controller-b10').innerHTML = buggy_up_down;
            //var value = document.getElementById('controller-b10').innerHTML;
            //var stick_data_new_left_up_down = {"b": buggy_up_down};
                    fetch("/joystick_data_new", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({"b": buggy_front_back}),
                    })
                    .then((response) => response.text())
                    .then((data) => console.log(data))
                    .catch((error) => console.error(error));
                }
        
          function sendDataToServerNewcameraleftright(camera_left_right) {
            //document.getElementById('controller-b11').innerHTML = camera_left_right;
            //var value = document.getElementById('controller-b11').innerHTML;
            //var stick_data_new_right_left_right = {"c": camera_left_right};
                    fetch("/joystick_data_new", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({"c": camera_left_right}),
                    })
                    .then((response) => response.text())
                    .then((data) => console.log(data))
                    .catch((error) => console.error(error));
                }
        
          function sendDataToServerNewcameraupdown(camera_up_down) {
            //document.getElementById('controller-b11').innerHTML = camera_up_down;
            //var value = document.getElementById('controller-b11').innerHTML;
            //var stick_data_new_right_up_down = {"d": camera_up_down};
                    fetch("/joystick_data_new", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({"d": camera_up_down}),
                    })
                    .then((response) => response.text())
                    .then((data) => console.log(data))
                    .catch((error) => console.error(error));
                }

        /*function sendDataToServerNewLeftLeftRight(buggy_left_right) {
            document.getElementById('controller-b10').innerHTML = buggy_left_right;
            var value = document.getElementById('controller-b10').innerHTML;
            var stick_data_new_left_left_right = {"a": value};
            $.ajax({ 
                url: '/joystick_data_new', 
                type: 'POST', 
                contentType: 'application/json', 
                data: JSON.stringify(stick_data_new_left_left_right),
                error: function(error) { 
                    console.log(error); 
                } 
            }); 
          }
    
        function sendDataToServerNewLeftUpDown(buggy_up_down) {
            document.getElementById('controller-b10').innerHTML = buggy_up_down;
            var value = document.getElementById('controller-b10').innerHTML;
            var stick_data_new_left_up_down = {"b": value};
            $.ajax({ 
                url: '/joystick_data_new', 
                type: 'POST', 
                contentType: 'application/json', 
                data: JSON.stringify(stick_data_new_left_up_down),
                error: function(error) { 
                    console.log(error); 
                } 
            }); 
        }

        function sendDataToServerNewRightLeftRight(camera_left_right) {
            document.getElementById('controller-b11').innerHTML = camera_left_right;
            var value = document.getElementById('controller-b11').innerHTML;
            var stick_data_new_right_left_right = {"c": value};
            $.ajax({ 
                url: '/joystick_data_new', 
                type: 'POST', 
                contentType: 'application/json', 
                data: JSON.stringify(stick_data_new_right_left_right),
                error: function(error) { 
                    console.log(error); 
                } 
            }); 
        }

        function sendDataToServerNewRightUpDown(camera_up_down) {
            document.getElementById('controller-b11').innerHTML = camera_up_down;
            var value = document.getElementById('controller-b11').innerHTML;
            var stick_data_new_right_up_down = {"d": value};
            $.ajax({ 
                url: '/joystick_data_new', 
                type: 'POST', 
                contentType: 'application/json', 
                data: JSON.stringify(stick_data_new_right_up_down),
                error: function(error) { 
                    console.log(error); 
                } 
            }); 
        }*/

        /*console.log(buggy_left_right);
        console.log(buggy_up_down);
        console.log(camera_left_right);
        console.log(camera_up_down);
        sendDataToServerNewLeftLeftRight(buggy_left_right);
        sendDataToServerNewLeftUpDown(buggy_up_down);
        sendDataToServerNewRightLeftRight(camera_left_right);
        sendDataToServerNewRightUpDown(camera_up_down);*/

        let controllerIndex = null;

        window.addEventListener("gamepadconnected", (event) => {
          handleConnectDisconnect(event, true);
        });

        window.addEventListener("gamepaddisconnected", (event) => {
          handleConnectDisconnect(event, false);
        });

        function handleConnectDisconnect(event, connected) {
          const controllerAreaNotConnected = document.getElementById(
              "controller-not-connected-area"
          );
          const controllerAreaConnected = document.getElementById(
              "controller-connected-area"
          );
      
          const gamepad = event.gamepad;
          console.log(gamepad);
      
          if (connected) {
              controllerIndex = gamepad.index;
              controllerAreaNotConnected.style.display = "none";
              controllerAreaConnected.style.display = "block";
              createButtonLayout(gamepad.buttons);
              createAxesLayout(gamepad.axes);
          } else {
              controllerIndex = null;
              controllerAreaNotConnected.style.display = "block";
              controllerAreaConnected.style.display = "none";
          }
        }

        function createAxesLayout(axes) {
          const buttonsArea = document.getElementById("buttons");
          for (let i = 0; i < axes.length; i++) {
              buttonsArea.innerHTML += `<div id=axis-${i} class='axis'>
                                          <div class='axis-name'>AXIS ${i}</div>
                                          <div class='axis-value'>${axes[i].toFixed(
                                              4
                                          )}</div>
                                      </div> `;
          }
        }
  
        function createButtonLayout(buttons) {
          const buttonArea = document.getElementById("buttons");
          buttonArea.innerHTML = "";
          for (let i = 0; i < buttons.length; i++) {
          buttonArea.innerHTML += createButtonHtml(i, 0);
          }
        }

        function createButtonHtml(index, value) {
          return `<div class="button" id="button-${index}">
                      <svg width="10px" height="50px">
                          <rect width="10px" height="50px" fill="grey"></rect>
                          <rect
                              class="button-meter"
                              width="10px"
                              x="0"
                              y="50"
                              data-original-y-position="50"
                              height="50px"
                              fill="rgb(60, 61, 60)"
                          ></rect>
                      </svg>
                      <div class='button-text-area'>
                          <div class="button-name">B${index}</div>
                          <div class="button-value">${value.toFixed(2)}</div>
                      </div>
                  </div>`;
        }

        function updateButtonOnGrid(index, value) {
          const buttonArea = document.getElementById(`button-${index}`);
          const buttonValue = buttonArea.querySelector(".button-value");
          buttonValue.innerHTML = value.toFixed(2);
      
          const buttonMeter = buttonArea.querySelector(".button-meter");
          const meterHeight = Number(buttonMeter.dataset.originalYPosition);
          const meterPosition = meterHeight - (meterHeight / 100) * (value * 100);
          buttonMeter.setAttribute("y", meterPosition);
        }
      
        function updateControllerButton(index, value) {
          const button = document.getElementById(`controller-b${index}`);
          const selectedButtonClass = "selected-button";
          1;
          if (button) {
              if (value > 0) {
              button.classList.add(selectedButtonClass);
              button.style.filter = `contrast(${value * 200}%)`;
              } else {
              button.classList.remove(selectedButtonClass);
              button.style.filter = `contrast(100%)`;
              }
          }
        }

        function handleButtons(buttons) {
          for (let i = 0; i < buttons.length; i++) {
              const buttonValue = buttons[i].value;
              updateButtonOnGrid(i, buttonValue);
              updateControllerButton(i, buttonValue);
          }
        }
  
        function handleSticks(axes) {
          updateAxesGrid(axes);
          updateStick("controller-b10", axes[0], axes[1]);
          updateStick("controller-b11", axes[2], axes[3]);
        }
  
        function updateAxesGrid(axes) {
          for (let i = 0; i < axes.length; i++) {
              const axis = document.querySelector(`#axis-${i} .axis-value`);
              const value = axes[i];
              // if (value > 0.06 || value < -0.06) {
              axis.innerHTML = value.toFixed(4);
              // }
          }
        }

        function updateStick(elementId, leftRightAxis, upDownAxis) {
          const multiplier = 25;
          const stickLeftRight = leftRightAxis * multiplier;
          const stickUpDown = upDownAxis * multiplier;
  
          const stick = document.getElementById(elementId);
          const x = Number(stick.dataset.originalXPosition);
          const y = Number(stick.dataset.originalYPosition);
  
          stick.setAttribute("cx", x + stickLeftRight);
          stick.setAttribute("cy", y + stickUpDown);
  
        }
  
        function handleRumble(gamepad) {
          const rumbleOnButtonPress = document.getElementById("rumble-on-button-press");
  
          if (rumbleOnButtonPress.checked) {
              if (gamepad.buttons.some((button) => button.value > 0)) {
              gamepad.vibrationActuator.playEffect("dual-rumble", {
                  startDelay: 0,
                  duration: 25,
                  weakMagnitude: 1.0,
                  strongMagnitude: 1.0,
              });
              }
          }
        }

        var buggy_left_right = 0;
        var buggy_front_back = 0;
        var camera_left_right = 0;
        var camera_up_down = 0;
        var movement_list = [];

        function gameLoop() {
          if (controllerIndex !== null) {
              const gamepad = navigator.getGamepads()[controllerIndex];
              handleButtons(gamepad.buttons);
              handleSticks(gamepad.axes);
              handleRumble(gamepad);
              // controllerInput();
              
              buggy_left_right = gamepad.axes[0];
              // sendDataToServerNewLeftLeftRight();
              buggy_front_back = gamepad.axes[1];
              // sendDataToServerNewLeftUpDown();
              camera_left_right = gamepad.axes[3];
              // sendDataToServerNewRightLeftRight();
              camera_up_down = gamepad.axes[2];
              //console.log(gamepad.axes[0] + " "+ gamepad.axes[1])
              //console.log(buggy_front_back)

              // sendDataToServerNewRightUpDown();
              // console.log("buggy left right: ", buggy_left_right);

              /*if (buggy_left_right > 0.3 || buggy_left_right < -0.3){
                sendDataToServerNewbugleftright(buggy_left_right)
              }
              if (buggy_front_back > 0.3 || buggy_front_back < -0.3){
                sendDataToServerNewbugfrontback(buggy_front_back)
              }
              else if (camera_left_right > 0.3 || camera_left_right < -0.3){
                sendDataToServerNewcameraleftright(camera_left_right)
              }
              else if (camera_up_down > 0.3 || camera_up_down < -0.3){
                sendDataToServerNewcameraupdown(camera_up_down)*/
              
              /*movement_list = [buggy_left_right, buggy_front_back]*/
              movement_list.push(buggy_left_right)
              movement_list.push(buggy_front_back)
              setTimeout(function(){ sendDataToServerNewbugleftright(movement_list) }, 200);
              //sendDataToServerNewbugleftright(movement_list)
          }
          requestAnimationFrame(gameLoop);
        }
  
        // setTimeout(gameLoop(),2000);
        window.requestAnimationFrame(gameLoop)

        function sendDataToServerNewbugleftright(movement_list) {
          //ocument.getElementById('controller-b10').innerHTML = buggy_left_right;
          //var value = document.getElementById('controller-b10').innerHTML;
          //var stick_data_new_left_left_right = {"a": buggy_left_right};
                  fetch("/joystick_data_new", {
                      method: "POST",
                      headers: {
                          "Content-Type": "application/json",
                      },
                      body: JSON.stringify({"a": movement_list}),
                  })
                  .then((response) => response.text())
                  .then((data) => console.log(data))
                  .catch((error) => console.error(error));
              }
              /*function sendDataToServerNewbugfrontback(buggy_front_back) {
                //document.getElementById('controller-b10').innerHTML = buggy_up_down;
                //var value = document.getElementById('controller-b10').innerHTML;
                //var stick_data_new_left_up_down = {"b": buggy_up_down};
                        fetch("/joystick_data_new", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"b": buggy_front_back}),
                        })
                        .then((response) => response.text())
                        .then((data) => console.log(data))
                        .catch((error) => console.error(error));
                    }
            
              function sendDataToServerNewcameraleftright(camera_left_right) {
                //document.getElementById('controller-b11').innerHTML = camera_left_right;
                //var value = document.getElementById('controller-b11').innerHTML;
                //var stick_data_new_right_left_right = {"c": camera_left_right};
                        fetch("/joystick_data_new", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"c": camera_left_right}),
                        })
                        .then((response) => response.text())
                        .then((data) => console.log(data))
                        .catch((error) => console.error(error));
                    }
            
              function sendDataToServerNewcameraupdown(camera_up_down) {
                //document.getElementById('controller-b11').innerHTML = camera_up_down;
                //var value = document.getElementById('controller-b11').innerHTML;
                //var stick_data_new_right_up_down = {"d": camera_up_down};
                        fetch("/joystick_data_new", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"d": camera_up_down}),
                        })
                        .then((response) => response.text())
                        .then((data) => console.log(data))
                        .catch((error) => console.error(error));
                    }*/
          function map_value(value, in_min, in_max, out_min, out_max){
            return (value - in_min) * (out_max - out_min) / (in_max - in_min) + out_min
          }
                

	</script>

	</body>
</html>

